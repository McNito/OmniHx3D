<!doctype html>

<html lang="en">

<!-- Mirrored from babylonhx.com/demos/srchxjs/physicsoimohx1.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 01 Apr 2016 00:44:27 GMT -->
<head>
  <meta charset="utf-8">

  <title>BabylonHx</title>
  <meta name="description" content="The HTML5 Herald">
  <meta name="author" content="SitePoint">

  <link rel="stylesheet" href="styles/github.css">
  <style>
	html, body {
		width: 100%;
		height: 100%;
		overflow: hidden;
		margin: 0;
		padding: 0;
		background: url('../../img/abstract3d.jpg') center center fixed;
	}
	pre {
		width: 100%;
		max-width: 1170px;
		height: 100%;
		position: relative;
		margin: auto;
		overflow: auto;
	}
	code {
		padding-top: 2% !important;
		padding-left: 20px !important;
		padding-bottom: 40px !important;
	}
  </style>
</head>

<body>
	<pre><code class="haxe">package samples;

import com.omnihx3d.cameras.ArcRotateCamera;
import com.omnihx3d.lights.DirectionalLight;
import com.omnihx3d.lights.HemisphericLight;
import com.omnihx3d.lights.shadows.ShadowGenerator;
import com.omnihx3d.materials.ShaderMaterial;
import com.omnihx3d.materials.ShadersStore;
import com.omnihx3d.materials.StandardMaterial;
import com.omnihx3d.materials.textures.CubeTexture;
import com.omnihx3d.materials.textures.Texture;
import com.omnihx3d.layer.Layer;
import com.omnihx3d.math.Color3;
import com.omnihx3d.math.Vector3;
import com.omnihx3d.mesh.Mesh;
import com.omnihx3d.physics.PhysicsBodyCreationOptions;
import com.omnihx3d.physics.plugins.OimoPlugin;
import com.omnihx3d.Scene;
import com.omnihx3d.Engine;
import com.omnihx3d.physics.PhysicsEngine;


class Physics {

	public function new(scene:Scene) {
		scene.enablePhysics(new Vector3(0, -2, 0), new OimoPlugin());
						
		var camera = new ArcRotateCamera("Camera", 0.86, 1.37, 450, Vector3.Zero(), scene);
		camera.attachControl(this);
		camera.maxZ = 50000;
		
		var light = new HemisphericLight("hemi", new Vector3(0, 1, 0), scene);
		
		new Layer("background", "assets/img/graygrad.jpg", scene, true);
				
		var mat = new StandardMaterial("ground", scene);
		var texDiff = new Texture("assets/img/wood2.jpg", scene);
		texDiff.uScale = texDiff.vScale = 5;
		mat.diffuseTexture = texDiff;
		mat.specularColor = Color3.Black();
		
		var g = Mesh.CreateBox("ground", 400, scene);
		g.position.y = -30;
		g.scaling.y = 0.01;
		g.material = mat;
		var physOpt = new PhysicsBodyCreationOptions();
		physOpt.mass = 0;
		g.setPhysicsState(PhysicsEngine.BoxImpostor, physOpt);
		
		var b1 = Mesh.CreateBox("b1", 50, scene);
		b1.position.x = -10;
		b1.material = mat;
		b1.setPhysicsState(PhysicsEngine.BoxImpostor, physOpt);
		
		var b11 = Mesh.CreateBox("b1", 40, scene);
		b11.position.x = -100;
		b11.scaling.y = 3;
		b11.position.y = 30;
		b11.material = mat;
		b11.setPhysicsState(PhysicsEngine.BoxImpostor, physOpt);
		
		var b111 = Mesh.CreateBox("b1", 200, scene);
		b111.position.z = -180;
		b111.scaling.y = 0.03;
		b111.scaling.z = 0.5;
		b111.position.y = 80;
		b111.rotation.x = Math.PI / 5;
		b111.material = mat;
		b111.setPhysicsState(PhysicsEngine.BoxImpostor, physOpt);
		
		var b2 = Mesh.CreateBox("b2", 400, scene);
		b2.position.z = -200;
		b2.scaling.z = 0.01;
		b2.scaling.y = 0.15;
		b2.material = mat;
		b2.setPhysicsState(PhysicsEngine.BoxImpostor, physOpt);
		
		var b3 = Mesh.CreateBox("b2", 400, scene);
		b3.position.z = 200;
		b3.scaling.z = 0.01;
		b3.scaling.y = 0.15;
		b3.material = mat;
		b3.setPhysicsState(PhysicsEngine.BoxImpostor, physOpt);
		
		var b4 = Mesh.CreateBox("b2", 400, scene);
		b4.position.x = 200;
		b4.scaling.x = 0.01;
		b4.scaling.y = 0.15;
		b4.material = mat;
		b4.setPhysicsState(PhysicsEngine.BoxImpostor, physOpt);
		
		var b5 = Mesh.CreateBox("b2", 400, scene);
		b5.position.x = -200;
		b5.scaling.x = 0.01;
		b5.scaling.y = 0.15;
		b5.material = mat;
		b5.setPhysicsState(PhysicsEngine.BoxImpostor, physOpt);
		
		// Get a random number between two limits
		var randomNumber = function (min:Float, max:Float) {
			if (min == max) {
				return (min);
			}
			var random = Math.random();
			return Std.int((random * (max - min)) + min);
		};
		
		// Initial height
		var y = 300;
		
		// all our objects
		var objects:Array&lt;Mesh&gt; = [];
		
		// max number of objects
		var max = 100;
		
		// Creates a random position above the ground
		var getPosition = function(y:Float):Vector3 {
			return new Vector3(randomNumber(-200, 200), y, randomNumber(-200, 200));
		};		
		
		var materialBall = new StandardMaterial("ball", scene);
		materialBall.diffuseTexture = new Texture("assets/img/metal.jpg", scene);
		materialBall.emissiveColor = new Color3(0.5, 0.5, 0.5);
		materialBall.diffuseTexture.uScale = 5;
		materialBall.diffuseTexture.vScale = 5;
		
		var materialCrate = new StandardMaterial("crate", scene);
		materialCrate.diffuseTexture = new Texture("assets/img/crate.jpg", scene);
		
		// Create objects
		for (index in 0...max) {
			
			// SPHERES
			var s = Mesh.CreateSphere("s", 30, randomNumber(20, 50), scene);
			s.position = getPosition(y);
			s.material = materialBall;
			physOpt = new PhysicsBodyCreationOptions();
			physOpt.mass = 1;
			physOpt.friction = 0.5;
			physOpt.restitution = 0.5;
			s.setPhysicsState(PhysicsEngine.SphereImpostor, physOpt);
			
			// BOXES
			var d = Mesh.CreateBox("b", randomNumber(10, 30), scene);
			d.position = getPosition(y);
			d.material = materialCrate;
			
			d.rotation.x = randomNumber( -Math.PI / 2, Math.PI / 2);
			d.rotation.y = randomNumber( -Math.PI / 2, Math.PI / 2);
			d.rotation.z = randomNumber( -Math.PI / 2, Math.PI / 2);
			d.setPhysicsState(PhysicsEngine.BoxImpostor, physOpt);
			
			// SAVE OBJECT
			objects.push(s);
			objects.push(d);
			
			// INCREMENT HEIGHT
			y += 10;
		}
				
		scene.getEngine().runRenderLoop(function () {
			scene.render();
		});
	}
	
}
</code></pre>

  <script src="highlight.pack.js"></script>  
  <script>
	hljs.configure({
	  tabReplace: '    ' // 4 spaces
	})
	hljs.initHighlightingOnLoad();
  </script>
</body>

<!-- Mirrored from babylonhx.com/demos/srchxjs/physicsoimohx1.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 01 Apr 2016 00:44:27 GMT -->
</html>